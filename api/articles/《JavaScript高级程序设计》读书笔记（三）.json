{"title":"《JavaScript高级程序设计》读书笔记（三）","slug":"《JavaScript高级程序设计》读书笔记（三）","date":"2017-11-07T14:07:10.000Z","updated":"2018-03-26T14:41:01.055Z","comments":true,"path":"api/articles/《JavaScript高级程序设计》读书笔记（三）.json","excerpt":"《JavaScript高级程序设计》读书笔记<br><br>","covers":null,"content":"<link rel=\"stylesheet\" href=\"/css/demobox.css\">《JavaScript高级程序设计》读书笔记<br><br><a id=\"more\"></a><p><strong>学习HTML新增的一些对象提供的API，包括canvas ，媒体事件等。</strong>(15-16章)</p><h1 id=\"第十五章-使用-Canvas-绘图\"><a href=\"#第十五章-使用-Canvas-绘图\" class=\"headerlink\" title=\"第十五章 使用 Canvas 绘图\"></a>第十五章 使用 Canvas 绘图</h1><h2 id=\"基本用法\"><a href=\"#基本用法\" class=\"headerlink\" title=\"基本用法\"></a>基本用法</h2><p>使用 <code>&lt;canves&gt;</code> 元素；指定 width 和 height 属性。</p><pre><code class=\"JavaScript\">&lt;canvas id=&quot;drawing&quot; width=&quot;200&quot; height=&quot;100&quot;&gt;Your browser doesn&#39;t support canvas&lt;/canvas&gt;\n</code></pre><p>要在画布上绘制，还需取得绘图上下文。</p><pre><code class=\"JavaScript\">var drawing = document.getElementById(&quot;drawing&quot;),\n//make sure &lt;canvas&gt; is completely supported\nif (drawing.getContext){\n    var context = drawing.getContext(&quot;2d&quot;);\n}\n</code></pre><h2 id=\"2D-上下文\"><a href=\"#2D-上下文\" class=\"headerlink\" title=\"2D 上下文\"></a>2D 上下文</h2><p><strong>填充和描边</strong>：2D 上下文的两种基本绘图操作。<br>fillStyle 属性（填充）：指定的样式（颜色、渐变或图像）填充图形；<br>strokeStyle 属性（描边）：只在图形边缘画线。</p><p><strong>绘制矩形</strong>：矩形是唯一一种可以直接在 2D上下文中绘制的形状。</p><p>与矩形有关的方法包括fillRect()、strokeRect和clearRect()。<br>这三个方法都能接收4个参数：矩形的x坐标、矩形的y坐标、矩形的宽度和矩形高度。</p><div class=\"demobox\"><div class=\"demobox-result\"><canvas id=\"drawing\" width=\"200\" height=\"100\">Your browser doesn&apos;t support the canvas tag.</canvas><script>!function(){var t=document.getElementById(\"drawing\");if(t.getContext){var e=t.getContext(\"2d\");e.fillStyle=\"#ff0000\",e.fillRect(10,10,50,50),e.strokeStyle=\"rgba(0,0,255,0.5)\",e.strokeRect(30,30,50,50),e.clearRect(40,40,10,10)}}()</script></div><div class=\"demobox-meta\"><span class=\"demobox-meta-collapse\" onclick=\"jQuery(this).parents(&apos;.demobox&apos;).toggleClass(&apos;demobox-expand&apos;)\"></span><div class=\"demobox-name\">&#x7ED8;&#x5236;&#x77E9;&#x5F62;</div></div><div class=\"demobox-code-wrap\"><div class=\"demobox-code demobox-html\"><figure class=\"highlight html\"><figcaption><span>html</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">canvas</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;drawing&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;200&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;100&quot;</span>&gt;</span>Your browser doesn&apos;t support the canvas tag.<span class=\"tag\">&lt;/<span class=\"name\">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class=\"demobox-code demobox-script\"><figure class=\"highlight javascript\"><figcaption><span>javascript</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> drawing = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">&quot;drawing&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (drawing.getContext){</span><br><span class=\"line\">    <span class=\"keyword\">var</span> context = drawing.getContext(<span class=\"string\">&quot;2d&quot;</span>);</span><br><span class=\"line\">    context.fillStyle = <span class=\"string\">&quot;#ff0000&quot;</span>;</span><br><span class=\"line\">    context.fillRect(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">    context.strokeStyle = <span class=\"string\">&quot;rgba(0,0,255,0.5)&quot;</span>;</span><br><span class=\"line\">    context.strokeRect(<span class=\"number\">30</span>, <span class=\"number\">30</span>, <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">    context.clearRect(<span class=\"number\">40</span>,<span class=\"number\">40</span>,<span class=\"number\">10</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure></div></div></div><p><strong>绘制路径</strong>：</p><p>首先调用 beginPath() 方法；<br>然后调用一下方法：<br>arc(x,y,radius,startAngle,endAngle,bool);<br>arcTo(x1,y1,x2,y2,radius);<br>lineTo(x,y);<br>moveTo(x,y);<br>rect(x,y,w,h);<br>最后调用 closePath() 方法。</p><p><strong>绘制文本</strong>：fillText(str, x, y, width);strokeText(str, x, y, width)。</p><div class=\"demobox\"><div class=\"demobox-result\"><canvas id=\"drawing2\" width=\"200\" height=\"200\">Your browser doesn&apos;t support the canvas tag.</canvas><script>!function(){var t=document.getElementById(\"drawing2\");if(t.getContext){var e=t.getContext(\"2d\");e.beginPath(),e.arc(100,100,99,0,2*Math.PI,!1),e.moveTo(194,100),e.arc(100,100,94,0,2*Math.PI,!1),e.moveTo(100,100),e.lineTo(100,15),e.moveTo(100,100),e.lineTo(35,100),e.stroke(),e.strokeText?(e.font=\"bold 14px Arial\",e.textAlign=\"center\",e.textBaseline=\"middle\",e.fillText(\"12\",100,20),e.textAlign=\"start\",e.fillText(\"12\",100,40),e.textAlign=\"end\",e.fillText(\"12\",100,60)):console.log(\"Your browser doesn't support the canvas text API.\")}}()</script></div><div class=\"demobox-meta\"><span class=\"demobox-meta-collapse\" onclick=\"jQuery(this).parents(&apos;.demobox&apos;).toggleClass(&apos;demobox-expand&apos;)\"></span><div class=\"demobox-name\">&#x7ED8;&#x5236;&#x8DEF;&#x5F84;&#x548C;&#x6587;&#x672C;</div></div><div class=\"demobox-code-wrap\"><div class=\"demobox-code demobox-html\"><figure class=\"highlight html\"><figcaption><span>html</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">canvas</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;drawing2&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;200&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;200&quot;</span>&gt;</span>Your browser doesn&apos;t support the canvas tag.<span class=\"tag\">&lt;/<span class=\"name\">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class=\"demobox-code demobox-script\"><figure class=\"highlight javascript\"><figcaption><span>javascript</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> drawing = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">&quot;drawing2&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (drawing.getContext){</span><br><span class=\"line\">    <span class=\"keyword\">var</span> context = drawing.getContext(<span class=\"string\">&quot;2d&quot;</span>);</span><br><span class=\"line\">    context.beginPath();</span><br><span class=\"line\">    context.arc(<span class=\"number\">100</span>, <span class=\"number\">100</span>, <span class=\"number\">99</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span> * <span class=\"built_in\">Math</span>.PI, <span class=\"literal\">false</span>);</span><br><span class=\"line\">    context.moveTo(<span class=\"number\">194</span>, <span class=\"number\">100</span>);</span><br><span class=\"line\">    context.arc(<span class=\"number\">100</span>, <span class=\"number\">100</span>, <span class=\"number\">94</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span> * <span class=\"built_in\">Math</span>.PI, <span class=\"literal\">false</span>);</span><br><span class=\"line\">    context.moveTo(<span class=\"number\">100</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">    context.lineTo(<span class=\"number\">100</span>, <span class=\"number\">15</span>);</span><br><span class=\"line\">    context.moveTo(<span class=\"number\">100</span>, <span class=\"number\">100</span>);</span><br><span class=\"line\">    context.lineTo(<span class=\"number\">35</span>, <span class=\"number\">100</span>);</span><br><span class=\"line\">    context.stroke();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (context.strokeText){</span><br><span class=\"line\">        context.font = <span class=\"string\">&quot;bold 14px Arial&quot;</span>;</span><br><span class=\"line\">        context.textAlign = <span class=\"string\">&quot;center&quot;</span>;</span><br><span class=\"line\">        context.textBaseline = <span class=\"string\">&quot;middle&quot;</span>;</span><br><span class=\"line\">        context.fillText(<span class=\"string\">&quot;12&quot;</span>, <span class=\"number\">100</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\">        context.textAlign = <span class=\"string\">&quot;start&quot;</span>;</span><br><span class=\"line\">        context.fillText(<span class=\"string\">&quot;12&quot;</span>, <span class=\"number\">100</span>, <span class=\"number\">40</span>);</span><br><span class=\"line\">        context.textAlign = <span class=\"string\">&quot;end&quot;</span>;</span><br><span class=\"line\">        context.fillText(<span class=\"string\">&quot;12&quot;</span>, <span class=\"number\">100</span>, <span class=\"number\">60</span>);</span><br><span class=\"line\">    } <span class=\"keyword\">else</span> {</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;Your browser doesn&apos;t support the canvas text API.&quot;</span>);</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure></div></div></div><p><strong>变换</strong>：<br>rotate(angle): 围绕原点旋转图像angle角度。<br>scale(scaleX, scaleY): 缩放图像。<br>translate(x,y)：将坐标原点移到（x,y）。</p><p><strong>阴影</strong>：<br>shadowColor()<br>shadowOffsetX:x方向的阴影偏移量。<br>shadowOffsetY:y方向的阴影偏移量。<br>shadowBlur:模糊的像素数，默认为0不模糊。</p><p><strong>渐变</strong>：渐变由 CanvasGradient 实例表示。</p><p>线性渐变：createLinearGradient(x1,y1,x2,y2);</p><pre><code class=\"JavaScript\">var gradient = context.createLinearGradient(30,30,70,70);\n    gradient.addColorStop(0,&quot;orange&quot;);\n    gradient.addColorStop(1, &quot;blue&quot;);\n    context.fillStyle = gradient;\n    context.fillRect(30, 30,70,70);\n</code></pre><p>径向渐变：createRadialGradient(x1,y1,r1,x2,y2,r2);</p><pre><code class=\"JavaScript\">var gra = context.createRadialGradient(55,55,10,55,55,30);\n    gra.addColorStop(0, &quot;blue&quot;);\n    gra.addColorStop(1, &quot;orange&quot;);\n    context.fillStyle = gra;\n    context.fillRect(30,30,50,50);\n</code></pre><p><strong>模式</strong>：模式就是重复的图像，可以用来填充或描边图形。</p><p>createPattern(img, str);<br>img： 表示一个 HTML 的 img 元素；<br>str： 可取值 “repeat”、“repeat-x”、“repeat-y”和“no-repeat”。</p><pre><code class=\"JavaScript\">var img = document.images[0];\nvar pattern = context.createPattern(img, &quot;repeat&quot;);\ncontext.fillStyle = pattern;\ncontext.fillRect(10,10,150,150);\n</code></pre><h2 id=\"WebGL\"><a href=\"#WebGL\" class=\"headerlink\" title=\"WebGL\"></a>WebGL</h2><p>WebGL 是针对 Canvas 的 3D 上下文。</p><h1 id=\"第十六章-HTML5-脚本编程\"><a href=\"#第十六章-HTML5-脚本编程\" class=\"headerlink\" title=\"第十六章 HTML5 脚本编程\"></a>第十六章 HTML5 脚本编程</h1><h2 id=\"跨文档消息传递\"><a href=\"#跨文档消息传递\" class=\"headerlink\" title=\"跨文档消息传递\"></a>跨文档消息传递</h2><p>跨文档消息传递，简称XDM，指的是来自不同域的页面间传递消息。</p><p>postMessage() 发送消息：</p><pre><code class=\"JavaScript\">var iframeWindow = document.getElementById(&quot;myFrame&quot;).contentWindow;\niframeWindow.postMessage(&quot;A secret&quot;, &quot;http://www.wshunli.com&quot;);\n</code></pre><p>接收消息，触发 window 对象的 message 事件，异步方式。</p><pre><code class=\"JavaScript\">window.addEventListener(&quot;message&quot;,function(){\n    if(event.origin == &quot;http://www.wshunli.com&quot;){//发送消息的文档所在的域\n      processMessage(event.data); //处理接收的数据\n      event.source.postMessage(&quot;Received!&quot;, &quot;http://github.com&quot;); //可选：向来源窗口发送回执\n  }\n},false)\n</code></pre><h2 id=\"媒体元素\"><a href=\"#媒体元素\" class=\"headerlink\" title=\"媒体元素\"></a>媒体元素</h2><p>HTML5新增了 <code>&lt;audio&gt;</code> 和 <code>&lt;video&gt;</code> 两个标签。</p><pre><code class=\"JavaScript\">&lt;video src=&quot;conference.mpg&quot; id=&quot;muvideo&quot;&gt;video palyer not available&lt;/video&gt;\n&lt;audio src=&quot;song.mp3&quot; id=&quot;myAudio&quot;&gt;audio player not available&lt;/audio&gt;\n</code></pre>","categories":[{"name":"前端技术","path":"api/categories/前端技术.json"}],"tags":[{"name":"JavaScript","path":"api/tags/JavaScript.json"},{"name":"读书笔记","path":"api/tags/读书笔记.json"},{"name":"《JavaScript高级程序设计》","path":"api/tags/《JavaScript高级程序设计》.json"}]}